<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>â¤Email Proforma *</title>
<style>
	.pnl * {
		min-width:100px; min-height:100px; margin:4px;
		background-color:#ffa; border:1px solid grey;
	}
	button { width: 50px; height: 20px; border: thin solid #000; margin: 2px 4px; outline:none; }
  span {
    display: inline-block;
    margin: 5px;
    border: thin solid #ddd;
    border-radius: 6px;
    font-size: 24px;
    line-height: 30px;
    min-width: 30px;
    height: 30px;
    text-align: center;
  }
  span:hover { cursor: pointer; background-color: yellow; }
  div { padding: 10px; }
</style>
</head>
<body style="font:normal 15px Arial,sans-serif;">

<button onclick="arrange(0)" style="background-color:#f60;"></button>
<button onclick="arrange(1)" style="background-color:#06c;"></button>
<button onclick="arrange(2)" style="background-color:#093;"></button>
<button onclick="arrange(3)" style="background-color:#b3f;"></button>
<button onclick="arrange(4)" style="background-color:#369;"></button>
<button onclick="arrange(5)" style="background-color:#c90;"></button>
<button onclick="arrange(6)" style="background-color:#c69;"></button>
<button onclick="arrange(7)" style="background-color:#aaa;"></button>
<button onclick="arrange(8)" style="background-color:#8fa6bc;"></button>
<button onclick="arrange(9)" style="background-color:#000;"></button>
<button onclick="Clear()" style="background-color:#fff;">Clear</button>
<button onclick="clearUnder()" style="background-color:#fff;">No '_'</button>

<div id="board" style="border:1px dashed grey;font-size:15px;padding:8px;" contentEditable='true'>
<table id="tblClip" cellpadding="0" cellspacing="0" border="0" width="100%" style="font-family:Arial,sans-serif;font-size:15px; background-color:#ccc;line-height:1.4;">
  <tr>
    <td style="width:10%;"></td>
    <td style="width:80%;background-color:#666;color:#fff;padding:24px 5%;">
Lorem ipsum dolor sit amet, _consectetuer_ adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.
    </td>
    <td style="width:10%;"></td>
  </tr>
  <tr>
    <td style="width:10%;"></td>
    <td style="width:80%;background-color:#f0f0f0;font-size:15px;padding:24px 5%;">
Lorem ipsum dolor sit _amet_, consectetuer adipiscing elit, sed diam nonummy nibh _euismod_ tincidunt ut laoreet dolore magna aliquam erat volutpat. Ut wisi enim ad minim veniam, quis nostrud exerci tation ullamcorper suscipit lobortis nisl ut aliquip ex ea commodo consequat.
    </td>
    <td style="width:10%;"></td>
  </tr>
</table>
</div>
<div id='clip' contentEditable='true' style='display:none'></div>
<input id="txt" type="text" style='display:none' value=""/>

<br><font style="float:right;color:#c66">*use underline '_' as delimiters.</font><br>
<div onclick="getSymbol()">
<span>â‚¬</span><span>Â§</span><span>Â±</span><span>Â°</span><span>âœ</span><span>âš‘</span><span>ğŸ“</span><span>ğŸ“Œ</span><span>â–‰</span><span>â˜…</span><span>â‰ˆ</span><span>âˆ¼</span><span>âœ”</span><span>âœ–</span><span>âœ˜</span><span>âŒ</span><span>âœ…</span><span>&nbsp;</span><br>

<span>â‘ </span><span>â‘¡</span><span>â‘¢</span><span>â‘£</span><span>â‘¤</span><span>â‘¥</span><span>â‘¦</span><span>â‘§</span><span>â‘¨</span><span>â‘©</span><br>
<span>â’¶</span><span>â’·</span><span>â’¸</span><span>â’¹</span><span>â’º</span><span>â’»</span><span>â’¼</span><span>â’½</span><span>â’¾</span><span>â’¿</span><br>

<span>âŠ</span><span>â‹</span><span>âŒ</span><span>â</span><span>â</span><span>â</span><span>â</span><span>â‘</span><span>â’</span><span>â“</span><br>
<span>â°</span><span>Â¹</span><span>Â²</span><span>Â³</span><span>â´</span><span>âµ</span><span>â¶</span><span>â·</span><span>â¸</span><span>â¹</span><span>âº</span><span>âˆ</span><span>âˆš</span><span>Ï€</span><br>

<span>â—</span><span>â˜</span><span>âœ†</span><span>âŒ•</span><span>âœ‰</span><span>âœ</span><span>â¤</span><span>â¨€</span><span>â¨‚</span><span>â—‰</span><span>âš </span><span>â˜¢</span><span>â‚</span><span>â‚¿</span><span>â–‘</span><span>â–£</span><span>â˜</span><span>ğŸ‘</span><span>â€</span><span>â€œ</span><span>â®</span><span>â¯</span><span>Â«</span><span>Â»</span><br>

<span>â–¸</span><span>â–¹</span><span>â¸±</span><span>â€“</span><span>â</span><span>â‡¢</span><span>&rarr;</span><span>&larr;</span><span>&uarr;</span><span>&darr;</span><span>âœ</span><span>â¤</span></div>
<br>

<script>
  const cls = [
{ margin: "#ffe0cc",head: "#f60", headText: "#fff", body: "#fff0e6", bodyText: "#331400", borderSus: "#feb", border: "#fa0"},
{ margin: "#cef",   head: "#06c", headText: "#fff", body: "#fff", bodyText: "#013", borderSus: "#6ad", border: "#0ae"},
{ margin: "#cec",   head: "#093", headText: "#fff", body: "#fff", bodyText: "#031", borderSus: "#0c0", border: "#0e0"},
{ margin: "#eee6ff",head: "#96c", headText: "#fff", body: "#fff", bodyText: "#103", borderSus: "#c8f", border: "#b8e"},
{ margin: "#d9e6f2",head: "#369", headText: "#fff", body: "#fff", bodyText: "#234", borderSus: "#0ac", border: "#0ac"},
{ margin: "#fff2cc",head: "#c90", headText: "#fff", body: "#fffff0", bodyText: "#330", borderSus: "#fc0", border: "#ea0"},
{ margin: "#f2d9e6",head: "#c69", headText: "#fff", body: "#fff", bodyText: "#413", borderSus: "#f8c", border: "#e8b"},
{ margin: "#ddd",   head: "#666", headText: "#fff", body: "#fff", bodyText: "#333", borderSus: "#c66", border: "#f88"},
{ margin: "#cfd8e2",head: "#607d9f", headText: "#fff", body: "#eff2f5", bodyText: "#304050", borderSus: "#bfcbd9", border: "#bfcbd9"},
{ margin: "#666",   head: "#000", headText: "#ddd", body: "#444", bodyText: "#fff", borderSus: "#880", border: "#880"}
  ];

  const _dv = document.getElementById("board"),
        _cl = document.getElementById('clip'),
        _tb = document.getElementById('tblClip'),
        _txt= document.getElementById('txt');
  
  function arrange(ix) {
      _tb.style.backgroundColor = cls[ix].margin;
    let box = _tb.rows[0].cells[1].style;
      box.backgroundColor = cls[ix].head;
      box.color = cls[ix].headText;
    box = _tb.rows[1].cells[1].style;
      box.backgroundColor = cls[ix].body;
      box.color = cls[ix].bodyText;
    underLine(0, cls[ix].borderSus);
    underLine(1, cls[ix].border);
    copyThat();
  }
  
  function underLine(rw, brd) {
    let ob = _tb.rows[rw].cells[1], dvs = ob.querySelectorAll("i");
    for(var d of dvs) d.style.borderColor = brd;
    if(ob.innerHTML.indexOf('_') >= 0)
    ob.innerHTML = ob.innerHTML.replace(/_(.+?)_/g, `<i style='font-style:normal;border:1px solid ${brd};'>&nbsp;$1&nbsp;</i>`);
  }
  
  function clearUnder() {
    for(let i=0; i<2; i++)
      _tb.rows[i].cells[1].innerHTML = _tb.rows[i].cells[1].innerHTML.replace(/<i .+?>&nbsp;(.+?)&nbsp;<\/i>/g,'$1');
  }

  function copyThat() {
    _dv.style.backgroundColor = '#f00';
    setTimeout(()=>{ _dv.style.backgroundColor = '';},300);
    _cl.style.display = 'block';
    _cl.innerHTML = _dv.innerHTML;
    setFocus(_cl);
    document.execCommand('selectAll', false, '');
    document.execCommand('copy', false, '');
    _cl.style.display = 'none';
  }
  
  function setFocus(nd){
    let s = window.getSelection(), r = document.createRange()
    r.setStart(nd, 0);
    r.setEnd(nd, 0);
    s.removeAllRanges();
    s.addRange(r);
  }

  function getSymbol() {
    var el = event.target; if(el.tagName != 'SPAN') return;
    el.style.backgroundColor = 'orange';
    setTimeout(()=>{ el.style.backgroundColor = ''; },300);
    _txt.style.display = '';
    _txt.value = el.innerText;
    _txt.focus();
    document.execCommand('selectAll', false, '');
    document.execCommand('copy', false, '');
    _txt.style.display = 'none';
  }
  
  function Clear() {
    _tb.rows[0].cells[1].innerText = '.';
    _tb.rows[1].cells[1].innerText = '.';
  }
  
  _dv.addEventListener('keyup', (e) => {
    if(e.key == '_') {
      underLine(0, cls[Indx].borderSus);
      underLine(1, cls[Indx].border);
    }
  });

  arrange(7);
  
</script>
</body>
</html>
