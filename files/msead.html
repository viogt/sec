<!DOCTYPE html>
<html>
   <head>
      <title>The Materialize Form Example</title>
      <meta name = "viewport" content = "width = device-width, initial-scale = 1">
      <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <style>
.navbar {
    overflow: hidden;
    background-color: #448;
    position: fixed;
    top: 0;
    width: inherit;
    z-index: 2;
    /*box-shadow: 0px 2px 6px #668;*/
}

.navbar a {
    float: left;
    display: block;
    color: #eef;
    text-align: center;
    padding: 12px 8px;
    text-decoration: none;
}

/*-------------------------------- Side Nav ------------------- */
.sideNav {
    /*font: normal 18px Arial,sans;*/
    height: 100%;
    width: 300px;
    position: fixed;
    z-index: 3;
    top: 0;
    left: -306px;
    /*background-color: #eef;*/
    overflow-x: hidden;
    overflow-y: auto;
    transition: left 0.4s;
    padding-top: 40px;
    /*border-right:1px solid #dde;
    box-shadow: 2px 0px 8px #888;*/
}

.sideNav a {
    padding: 8px 14px;
    margin: 0 26px 0 26px;
    text-decoration: none;
    color: #000;
    display: block;
    transition: 0.3s;
}

.sideNav a:hover {
    color: #fff;
    background-color:#009688;
}

.sideNav .closebtn {
    position: absolute;
    margin: 0;
    top: 0;
    right: 0;
    font-size: 36px;
    margin-left: 50px;
}


.main {
  margin-top: 72px;
  color:#000;
}
.fxBtn { width: 120px; }

/*--------------------------------- DROP BTN --------------------------*/
.dropbtn {
    background-color: #bbc;
    color: #fff;
    padding: 14px 0px;
    font: normal 16px Arial, sans;
    border: none;
    text-decoration: none;
    display: inline-block;
    cursor: pointer;
    width:65px;
    margin:0;
    text-align:center;
    box-shadow: 0px 3px 6px 0px #999;
}
.dropdown-content {
    position: absolute;
    overflow-x: hidden;
    white-space: nowrap;
    box-shadow: 0px 3px 6px 0px #999;
    z-index: 1;
    top:0; left:0;
    width: 0px;
    transition: width 0.4s;
}
.dropdown-content a {
    color: #fff;
    padding: 14px 0px;
    font: normal 16px Arial, sans;
    border: none;
    text-decoration: none;
    display: inline-block;
    width:65px;
    margin:0;
    text-align:center;
}

</style>
</head>

<body class='container'>

<!-- <div style='position:fixed;top:0;z-index:1;width:inherit;'>
<nav>
    <div class="nav-wrapper">
        <ul id="nav-mobile" class="left hide-on-med-and-down">
	<ul>
            <li>
                <a href="javascript:void()" onClick='openLeft()'><i class="material-icons">menu</i></a>
                </li>
            <li><a href="javascript:testTable(0)">Organic</a></li>
            <li><a href="javascript:testTable(1)">Specific</a></li>
            <li><a href="javascript:void()">About</a></li>
            <li><a href="javascript:void()"><i class="material-icons">insert_chart</i></a></li>
            <li><a href="javascript:randomise()"><i class="material-icons">equalizer</i></a></li>
        </ul>
 </div>
</nav>
</div> -->

<div class="navbar teal z-depth-2">
<a href="javascript:void()" onClick='openNav()'><i class="material-icons">menu</i></a>
<a href="javascript:testTable(0)">Organic</a>
<a href="javascript:testTable(1)">Specific</a>
<a href="javascript:void()" onclick='createCharts()'><i class="material-icons">insert_chart</i></a>
<a href="javascript:randomise()"><i class="material-icons">equalizer</i></a>
</div>

<div id='main' class='main'><div><ul class="collapsible">
        <li class="active">
            <div class="collapsible-header"><i class="material-icons">search</i>About SEAD</div>
            <div class="collapsible-body">
                SEAD stand to <a href='#'>Evaluation and Diagnosis System</a>. The tool aims to do the following. SEAD stand to Evaluation and Diagnosis System. The tool aims to do the following.
            </div>
        </li>
        <li>
            <div class="collapsible-header"><i class="material-icons">access_alarm</i>Problematics addressed</div>
            <div class="collapsible-body">
                SEAD is techniques to... Since the clinical psychological science has developed evaluation techniques, it is the time to offer technological solutions as assessment tools. Since the clinical psychological science has developed evaluation techniques, it is the time to offer technological solutions as assessment tools.
            </div>
        </li>
        <li>
            <div class="collapsible-header"><i class="material-icons">network_check</i>Solution and toolset</div>
            <div class="collapsible-body">
                By means of two basic questionnaires, which yield three forms of psychiatric assessment, SEAD is a toolset for… The two questionnaires (for organic and specific symptoms)... Here is the description of the <a href='#'>working model</a>.
            </div>
        </li>
        <li>
            <div class="collapsible-header"><i class="material-icons">playlist_add_check</i>Data validation</div>
            <div class="collapsible-body">
                From the psychological [clinical] standpoint, data and procedures validation was granted by the … in 2005. From the form-completing standpoint, the answers (data) are validated through <a href='#'>cross-examination</a> of relevant and check-supporting questions, in order to ensure data integrity, fortuitous error proofing and cheating protection.
            </div>
        </li>
        <li>
            <div class="collapsible-header"><i class="material-icons">build</i>Further project</div>
            <div class="collapsible-body">
                The range and area ought to be extended over… <a href='#'>databases</a> and facilities. Furthermore, Although the targets being diagnosed are not related to..., there is however a cultural dependency when it comes to questions, the way they are phrased, perceived and answered. The model extension would also include the EU correlation databases on the available records...
            </div>
        </li>
        <li>
            <div class="collapsible-header"><i class="material-icons">person</i>About the author</div>
            <div class="collapsible-body">
                Diana Topa is Dr. Phil. since 200X and MBA since 200Y. She had an extensive clinical practice in the Clinic of CH-MD... Here is the <a href='#'>curriculum vitae</a> (résumé) and the <a href='#'>accreditation list</a> of Diana Topaclass=""
            </div>
        </li>
</ul></div></div>

<div id="mySidenav" class="sideNav teal lighten-4 z-depth-2">
  <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>

  <div style='margin:26px; padding:20px; background-color:#fff; border:1px solid #ccc; border-radius:8px; text-align:center;box-shadow: 0px 3px 6px 0px #999;'>
      <img src='res/Diana_Topa.jpg' width='100%' height='100%'>
      <div style='margin:0; padding: 16px; background-color:#b2dfdb; text-align:center;'>
      <big><b>Diana Topa</b></big><br>
      Dr. Phil., MBA
      </div>
      <table style='margin-top:16px;'>
          <tr><td><i class="material-icons">zoom_in</i></td><td>
            Specialisation:<br>clinical evaluation
          </td></tr>
          <tr><td><i class="material-icons">mail_outline</i></td><td>
            <span style='color:blue;text-decoration:underline'>diana.topa@gmail.com</span>
          </td></tr>
      </table>
  </div>
<table style='margin-left:16px;'>
    <tr><td><i class="material-icons">search</i></td><td>
        <a href="javascript:void(0)" onclick='reInstate();closeNav();'>About S.E.A.D.</a>
    </td></tr>
    <tr><td><i class="material-icons">access_alarm</i></td><td>
        <a href="#">Problem and solution</a>
    </td></tr>
    <tr><td><i class="material-icons">network_check</i></td><td>
        <a href="#">Questionnaires</a>
    </td></tr>
    <tr><td><i class="material-icons">playlist_add_check</i></td><td>
        <a href="#">Data validation</a>
    </td></tr>
    <tr><td><i class="material-icons">build</i></td><td>
        <a href="#">Assessment & reports</a>
    </td></tr>
    <tr><td><i class="material-icons">person</i></td><td>
        <a href="#">CV & accreditations</a>
    </td></tr>
</table>
  <br>
</div>


<div class="fixed-action-btn">
  <a class="btn-floating btn-large teal" onClick='openNav()'>
    <i class="large material-icons">menu</i>
  </a>
  <ul>
    <li><a href='javascript:void()' class="btn-floating red" onclick='createCharts()'><i class="material-icons">insert_chart</i></a></li>
    <li><a href='javascript:void()' class="btn-floating yellow darken-1" onclick='reInstate()'><i class="material-icons">format_quote</i></a></li>
    <li><a href='javascript:void()' class="btn-floating green" onclick='tableDrop()'><i class="material-icons">publish</i></a></li>
    <li><a class="btn-floating blue"><i class="material-icons">attach_file</i></a></li>
  </ul>
</div>

<div id="scale" class="dropdown-content">
<a href='javascript:void()' onClick='answer(this)' style='background-color:#26a69a'>F. rar</a><a href='javascript:void()' onClick='answer(this)' style='background-color:#80cbc4'>Rar</a><a href='javascript:void()' onClick='answer(this)' style='background-color:#cddc39'>Mediu</a><a href='javascript:void()' onClick='answer(this)' style='background-color:#ffa726'>Des</a><a href='javascript:void()' onClick='answer(this)' style='background-color:#e65100'>F. des</a>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
<script>

var mainContent = null;

document.addEventListener('DOMContentLoaded', function() {
    
    M.AutoInit();
    /*var elems = document.querySelectorAll('.fixed-action-btn');
    var instances = M.FloatingActionButton.init(elems, options);
    var elems, instances;
    elems = document.querySelectorAll('.collapsible');
    instances = M.Collapsible.init(elems, options);
    try {
    elems = document.querySelectorAll('.dropdown-trigger');
    instances = new M.Dropdown.init(elems, { closeOnClick: true });
    } catch(e) { alert(e.message); }*/
    
    trageTot();
    
});

function id(x) { return document.getElementById(x); }
function openNav() {
    //id("mySidenav").style.left = '0px';
    //alert('LEFT:' + id("mySidenav").style.left);
    let el = id("mySidenav").style, s = el.left; el.left = (s.charAt(0)!='0')?'0':'-306px';
}
function closeNav() { id("mySidenav").style.left = "-306px"; }

function openLeft() {
    try {
    alert('Am ajuns\n' + sideNav);
    let elem = document.getElementById('slide-out');
    var instance = M.Sidenav.getInstance(elem);
    instance.open();
    } catch(e) { alert(e.message); }
}

function showToast(msg){ M.toast({html: msg }); }

function dualInput(td) {
    let d = document.createElement('div'); d.className = 'switch';
    let s = document.createElement('span'); s.className = 'lever';
    let i = document.createElement('input'); i.type = 'checkbox'; //i.checked = Math.random()>0.5?true:false;
    let l = document.createElement('label');
    l.appendChild(i); l.appendChild(s); d.appendChild(l); td.appendChild(d);
}

let selOps = ["Foarte rar", "Rar", "Mediu", "Des", "Foarte des"];
let culori = ["#26a69a", "#80cbc4", "#cddc39", "#ffa726", '#e65100'];

function selInput(rw, td) {
    let e_id = 'dropDn_' + rw, Lops = selOps.length;
    let a = document.createElement('a');
        a.className = 'dropdown-trigger btn fxBtn';
        a.setAttribute('data-target',e_id);
        a.textContent = selOps[0];
        a.href = 'javascript:void()';
    let u = document.createElement('ul');
        u.id = e_id;
        u.className = 'dropdown-content';
    for(let i=0; i<Lops; i++) {
        let l = document.createElement('li');
        let z = document.createElement('a');
        z.textContent = selOps[i]; z.href = '#!'; z.onclick = handleSel;
        l.appendChild(z); u.appendChild(l);
    }
    td.appendChild(a); td.appendChild(u);
}

function randomise() {
    if(insTip<0) return;
    let T = id('main').firstChild, R = T.rows, L = R.length;
    let optL = selOps.length-1;
    
    if(insTip==0) for(let i=0; i<L; i++) {
        let obj = R[i].cells[1].firstChild.firstChild.firstChild;
        obj.checked = Math.random()>0.5?true:false;
    }
    else if(insTip==1) for(let i=0; i<L; i++) {
        let obj = R[i].cells[1].firstChild, rnd = Math.round(Math.random()*optL);
        obj.innerText = selOps[rnd];
        obj.style.backgroundColor = culori[rnd];
    }
}

/*function multiInput(td) {
    let i = document.createElement('input');
    i.type = 'range'; i.min = 1; i.max = 5; i.value = Math.round(Math.random()*5);
    let p = document.createElement('p');
    //p.appendChild(i);
    td.appendChild(i);
}*/

var insTip = -1, tables;

function createTable(anch, tip) {
    let T = document.createElement('table'),
        B = document.createElement('tbody'),
        R = document.createElement('div'),
        H2 = document.createElement('h2'),
        culLen = culori.length-1,
        tbl = tables[tip].data, rws = tbl.length;
    for(let i=1; i<rws; i++) {
        let R = document.createElement('tr');
        let c = document.createElement('td'); c.innerText = tbl[i][1];
        R.appendChild(c);
        c = document.createElement('td');
        if(tip==0) dualInput(c);
        else if(tip==1) selInput(i, c);
        R.appendChild(c);
        B.appendChild(R);
    }
    T.appendChild(B); insTip = tip;
    while(anch.firstChild) anch.removeChild(anch.firstChild); anch.appendChild(T);
    if(tip==1) {
        let elems = document.querySelectorAll('.dropdown-trigger');
        let instances = M.Dropdown.init(elems, {closeOnClick: true});
    }
}

/*function mkTable(tbl, fl) {
    let T = document.getElementById(tbl), R = T.rows, L = R.length;
    for(let i=0; i<L; i++) {
            let nd = R[i].cells[1];
            while(nd.firstChild) nd.removeChild(nd.firstChild);
            if(fl==1) dualInput(nd);
            else if(fl==2) multiInput(nd);
            else selInput(i, nd);
    }
}*/

function handleSel() {
    //alert(this.nodeName + '\n' + this.innerText);
    let t = this.innerText, L = culori.length;
    let B = this.parentElement.parentElement.previousSibling;
    B.innerText = t;
    for(let i=0; i<L; i++) if(selOps[i]==t) { B.style.backgroundColor = culori[i]; return; }
    //alert(B.nodeName + '\n' + B.innerText);
}

function trageTot() {
	/*const el = document.createElement('script');
	el.onload = function() { tables = DATA; showToast('Data loaded'); };
	el.setAttribute('type', 'text/javascript');
    el.setAttribute('async', true);
    el.setAttribute('src', 'res/tables.js');
	document.body.appendChild(el);*/
	
    fetch('res/tables.json').then(response => { return response.json(); })
    .then(data => { tables = data; showToast('Data loaded'); })
    .catch(err => { alert('Error: ' + err.message); });
    
    mainContent=id("main").firstChild.cloneNode(true);
}

function testTable(tip) {
    //let a = id('main');
    createTable(id('main'), tip);
}

/* -------------------- Charts ------------------------------ */

const DT = {
  labels: ["Agresiv","Labil","Anxietate","Perseverari"],
  data: [88,43,31,9],
  title: "Organic Pesonality's Type",
  isChartLoaded: false
};

function randomChartData() { for(let d in DT.data) DT.data[d] = Math.round(Math.random()*100); }

function createCharts() {
    let D = document.createElement('div'),
        c1= document.createElement('canvas'),
        c2= document.createElement('canvas'),
        anch = id('main');
    c1.width="undefined"; c1.height="undefined"; c1.id='bars';
    c2.width="undefined"; c2.height="undefined"; c2.id='douhnuts';
    D.style.height = '400px';
    if(anch.firstChild) anch.removeChild(anch.firstChild);
    insTip = -1;
    D.appendChild(c1); D.appendChild(c2); anch.appendChild(D);
    randomChartData();
    if(DT.isChartLoaded) { makeBars(c1); makeDouhnuts(c2); }
    else {
        let el = document.createElement('script');
        el.onload = function() { isChartLoaded = true; makeBars(c1); makeDouhnuts(c2); };
        el.setAttribute('type', 'text/javascript');
        el.setAttribute('async', true);
        el.setAttribute('src', 'https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js');
        document.body.appendChild(el);
    }
}

function makeBars(wh) {
const Ch2 = new Chart(wh.getContext('2d'), {
    "type":"bar",
    "data": {
        "labels": DT.labels,
        "datasets":[
            {"label": DT.title,
            "data": DT.data,
            "fill":false,
            "backgroundColor":[
                "rgba(255, 0, 0, 0.5)",
                "rgba(255, 255, 0, 0.5)",
                "rgba(0, 0, 255, 0.5)",
                "rgba(0, 255, 0, 0.5)"
            ],
            "borderColor":[
                "rgb(255, 0, 0)",
                "rgb(255, 255, 0)",
                "rgb(0, 0, 255)",
                "rgb(0, 255, 0)"
            ],
            "borderWidth":1
            }]
    },
    "options":{
        "scales":{
            "yAxes":[
                { "ticks":{ "beginAtZero":true } }
            ]
        }
    }
});
}

function makeDouhnuts(wh) {
const Chat2 = new Chart(wh.getContext('2d'), {
    "type":"doughnut",
    "data":{
        "labels": DT.labels,
        "datasets":[
            {
                "label": DT.title,
                "data": DT.data,
                "backgroundColor":[
                "rgb(255, 0, 0)",
                "rgb(255, 255, 0)",
                "rgb(0, 0, 255)",
                "rgb(0, 255, 0)"
            ]
            }
        ]
    }
});
}

function reInstate() {
    const anch = id('main'); insTip = -1;
    while(anch.firstChild) anch.removeChild(anch.firstChild);
    anch.appendChild(mainContent);
    const elems = document.querySelectorAll('.collapsible');
    const instances = M.Collapsible.init(elems, {accordion: true});
}

const SCALE = document.getElementById('scale'), SCABTN = null;

function createDrop(anch) {
    let a = document.createElement('a');
    a.className = 'dropbtn';
    a.onclick = unfold;
    a.innerText = 'N/A';
    anch.appendChild(a);
}

function tableDrop() { //----------------------- drop ----------
    let T = document.createElement('table'),
        B = document.createElement('tbody'),
        anch = id('main'),
        tbl = tables[1].data, rws = tbl.length;
    for(let i=1; i<rws; i++) {
        let R = document.createElement('tr');
        let c0 = document.createElement('td'), c1 = document.createElement('td');
        createDrop(c0); c1.innerText = tbl[i][1];
        R.appendChild(c0); R.appendChild(c1);
        B.appendChild(R);
    }
    T.appendChild(B); insTip = 2;
    if(anch.firstChild) anch.removeChild(anch.firstChild); anch.appendChild(T);
}
function unfold() {
	let el = event.target, rct = el.getBoundingClientRect();
    if(SCALE.style.width == '325px') SCALE.style.width = '0';
    SCALE.style.top = (rct.top + window.scrollY) + 'px';
    SCALE.style.left = rct.left + 'px';
    SCALE.style.width = '325px';
    SCLBTN = el;
}

function answer(ob) {
	SCLBTN.innerText = ob.innerText;
    SCLBTN.style.backgroundColor = ob.style.backgroundColor;
}
</script>
</body>
</html>
